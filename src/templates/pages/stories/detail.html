{% extends "layouts/default.html" %}

{% from "macros/image.html" import image %}

{% block body_class %}body--story has-no-hero{% endblock %}

{% block content %}
<div class="content">
  <div class="content__inner">
    <div class="content__section">
      <ul class="filters">
        <li><a href="/blog/">Recent</a></li>
        <li><span class="separator"></span></li>

        {% for category in categories.categories %}
        <li><a href="{{ category | route('category') }}/#" {% if category.title == page.category[0].title %}class="is-current"{% endif %}>{{ category.title }}</a></li>
        {% endfor %}
      </ul>
    </div>

    <div class="content__section">
      <header class="content__header">
        <div class="content__rubric">
          <span>{{ page._enabledAt | date("MMMM D, YYYY") }}</span>

          {% for category in page.category %}
          <span>{{ category.title }}</span>
          {% endfor %}
        </div>

        <h2 class="content__heading">{{ page.title }}</h2>
      </header>

      <div class="content__content" v-story>{{ page.contentHtml | safe }}
        {% if page.shopStyleContent %}
        <div class=“shop-style”>{{ page.shopStyleContent | safe }}</div>
        {% endif %}

        <!-- vuukle -->
        <div id='vuukle-comments'></div>
        <!-- end vuukle -->
      </div>

      {% if page.relatedStories.length %}
      <div class="related-stories">
        <h2 class="related-stories__heading">You'll also love</h2>

        <ul class="related-stories__list">
          {% for story in page.relatedStories.slice(0,3) %}
          <li>
            <a href="{{ story | route('story') }}">
              <div class="related-stories__image">
                {{ image(story.tout.image.s3Key) }}
              </div>

              <h3 class="related-stories__title">{{ story.title }}</h3>
            </a>
          </li>
          {% endfor %}
        </ul>
      </div>
      {% endif %}
    </div>
  </div>
</div>

{% endblock %}

{% block extra_scripts %}
  <!-- vuukle script -->
  <script>
    var VUUKLE_CONFIG = {
      apiKey: "e264ea9e-ea8b-473c-b1ae-1618d35fa09a",
      articleId: "awaylands.com/" + "{{currentPath}}",
    };
    // DON'T EDIT BELOW THIS LINE
    (function() {
      var d = document,
        s = d.createElement('script');
      s.src = 'https://cdn.vuukle.com/platform.js';
      (d.head || d.body).appendChild(s);
    })();
  </script>
  <!-- end vuukle script -->

  {% if page.shopStyleContent %}
  <script type="text/javascript">
    (function(d, sc, u) {
      var s = d.createElement(sc), p = d.getElementsByTagName(sc)[0];
      s.type = 'text/javascript';
      s.async = true;
      s.src = u + '?v=' + (+new Date());
      p.parentNode.insertBefore(s,p);
    })(document, 'script', '//aff.bstatic.com/static/affiliate_base/js/flexiproduct.js');
  </script>
  {% endif %}
{% endblock %}
